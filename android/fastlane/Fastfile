default_platform(:android)

platform :android do
  desc "Build release APK for production"
  lane :build_apk do
    sh "flutter clean"
    sh "flutter build apk --release --flavor production --target lib/main_production.dart --no-tree-shake-icons"

    apk_path = "../build/app/outputs/flutter-apk/app-production-release.apk"
    UI.success("âœ… APK Generated at: #{apk_path}")
  end

  desc "Build and upload APK to Google Drive"
  lane :upload_drive do
    sh "flutter clean"
    sh "flutter build apk --release --flavor production --target lib/main_production.dart --no-tree-shake-icons"

    apk_path = "../build/app/outputs/flutter-apk/app-production-release.apk"

    # Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù Ø¹Ù„Ù‰ Google Drive ÙˆÙ…Ø´Ø§Ø±ÙƒØªÙ‡
    sh "gdrive files upload #{apk_path} --share"

    UI.success("ğŸš€ APK built and uploaded to Google Drive successfully!")
  end
end
